var insertCodeDlg=null;$(function(){function f(){insertCodeDlg.dialog("close")}$(".description a, .commentMessage a, .commentMessageFull a").attr("target","_blank");var a=30;$(".commentBlock").each(function(b){if($(this).height()>a){$(this).find(".commentMessageFull").css("height",a).css("overflow","hidden");$(this).append('<div class="expand-icon"></div>')}});$(".commentMessageFull, .expand-icon").live("click",function(a){if($(a.target).is("a"))return;var b=$(this);if(b.hasClass("expand-icon")){b.parents("div:first").find(".commentMessageFull").css("height","auto").css("overflow","visible");b.removeClass("expand-icon").addClass("collapse-icon")}else{b.css("height","auto").css("overflow","visible");b.next("div.expand-icon").removeClass("expand-icon").addClass("collapse-icon")}});$(".collapse-icon").live("click",function(){var b=$(this);b.parents("div:first").find(".commentMessageFull").css("height",a).css("overflow","hidden");b.removeClass("collapse-icon").addClass("expand-icon")});var b=$("#Comment_message");var c='<div class="form" id="insertCodeForm" style="overflow:hidden;position:relative; text-align:center;">	<textarea id="txtAreaCode" class="round6" 		style="width:410px;min-width:410px;max-width:410px;		height:320px;min-height:320px;max-height:320px;"></textarea></div>';$("body").append(c);insertCodeDlg=$("#insertCodeForm");var d=$("#txtAreaCode"),e=$(".codeBtn");insertCodeDlg.dialog({title:'<img alt="" src="/themes/bugkick_theme/images/icons/code.png" style="vertical-align:middle;" />Â Insert the code',autoOpen:false,width:450,height:450,resizable:false,modal:true,buttons:{OK:function(){var a=b.wysiwyg("getContent");var c=/</gi,e=/>/gi;b.wysiwyg("setContent",a+"\n{{{#!\n\n"+d.val().replace(c,"<").replace(e,">")+"\n\n!#}}}");f()},Cancel:function(){f()}}});$("#comment-form").submit(function(){var a=/{{{#![\s\S]*?!#}}}/gi,c=/</gi,d=/>/gi,e=/\s+(!#}}})/gi;matches=[];var f=null;var g=b.val();while(true){f=a.exec(g);if(f===null)break;var h=f[0];var i=h.replace(c,"<").replace(d,">").replace(e,"$1");g=g.replace(h,i)}b.val(g)})})
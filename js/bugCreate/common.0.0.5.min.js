function nearTrim(e,t,n){if(n===undefined)n="â€¦";if(t>=e.length)return e;return e.substr(0,t).replace(/\s+?(\S+)?$/,"").replace(/\s+$/,"")+n}function showBugTitle(e,t){var n=t.parent("div:first"),r=e.val();if(r.length==0)n.hide();else{var i=nearTrim(r,60);var s=i.indexOf("\n\n");if(s>0)t.text(i.substr(0,s));else t.text(i);n.show()}}function createTicket(){$.jGrowl.defaults.position="bottom-right";$.jGrowl.defaults.life=6e3;$("#bug-form").ajaxSubmit({beforeSubmit:function(e){bugkick.bug.create.clearDescriptionDump();$("#createBugDialog").dialog("close")},success:function(e){if($.fn.yiiListView&&!!$("#bug-list").length){var t=$("input#bugSearch").serialize();$.fn.yiiListView.update("bug-list",{data:t})}$.jGrowl("Ticket is created. <a href='/ticket/"+e.ticketNumber+"'>View</a> ");if(typeof e.redirect!="undefined"){window.location=e.redirect}},error:function(e){$.jGrowl("Please check the fields.")},dataType:"json"});return false}$(function(){function i(e){var t=e.attr("src"),n=/(bullet-toggle-)(minus)(-icon\d+\.png)$/,r=/(bullet-toggle-)(plus)(-icon\d+\.png)$/;if(n.test(t))t=t.replace(n,"$1plus$3");else t=t.replace(r,"$1minus$3");e.attr("src",t)}function s(e){e.find("a.label-form-submit-btn:first").hide();e.find("img.imgAjaxLoading:first").show()}function o(e){e.find("img.imgAjaxLoading:first").hide();e.find("a.label-form-submit-btn:first").show()}var e=$(".createBug_newLabelBtn"),t=e.parent().parent().parent().next(".newLabelContainer"),n=t.find("div.form-placeholder:first"),r=t.find("span.ajaxUrl:first").text();$("#createBugDialog, #updateBugDialog").bind("dialogbeforeclose",function(n,r){if(t.is(":visible")){t.hide();i(e)}});$(".createBug_newLabelBtn").live("click",function(){var e=$(this),t=e.parent().parent().parent().next(".newLabelContainer"),n=t.find("div.form-placeholder:first"),u=$(".label-select");if(t.is(":visible")){t.hide();i(e);return false}$.get(r,function(r){function f(){t.find("form:first").ajaxForm(a)}if(r.html===undefined)return;n.html(r.html);n.find("input.color_picker").miniColors([]);jQuery(".chzn-select").chosen();var a={beforeSubmit:function(e,t,n){s(t)},success:function(r){if(r.success){u.prepend('<option value="'+r.label.label_id+'">'+r.label.name+"</option>");u.val(r.label.label_id);u.trigger("liszt:updated");t.hide();i(e)}n.html(r.html);f();o(n.find("form:first"))},error:function(e){o(n.find("form:first"))}};f();t.show();i(e)});return false})})